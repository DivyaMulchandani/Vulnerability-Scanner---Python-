# mime_type_spoofing.py
import requests

def is_mime_type_spoofing_possible(url, file_path, spoofed_content_type="image/png"):
    """
    Tests for MIME type spoofing by uploading a non-image file with an image MIME type.
    """
    try:
        with open(file_path, 'rb') as f:
            files = {'file': (file_path, f, spoofed_content_type)}
            response = requests.post(f"{url}/upload", files=files)
        
        # If the server accepts the file, MIME type spoofing may be possible
        if response.status_code == 200 and "file uploaded" in response.text.lower():
            return True
    except FileNotFoundError:
        print(f"File {file_path} not found.")
    except requests.RequestException as e:
        print(f"Error during MIME type spoofing check: {e}")
    
    return False
