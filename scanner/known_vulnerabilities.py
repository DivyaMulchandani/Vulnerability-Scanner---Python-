# known_vulnerabilities.py
import subprocess
import json

def check_known_vulnerabilities(dependency_manager="npm"):
    """
    Checks for known vulnerabilities in dependencies.
    """
    if dependency_manager == "npm":
        command = ["npm", "audit", "--json"]
    elif dependency_manager == "pip":
        command = ["pip-audit", "--format", "json"]
    else:
        raise ValueError("Unsupported dependency manager")

    result = subprocess.run(command, capture_output=True, text=True)
    vulnerabilities = json.loads(result.stdout)
    
    if vulnerabilities:
        return vulnerabilities  # Returns details of vulnerabilities found
    return None  # No vulnerabilities found
