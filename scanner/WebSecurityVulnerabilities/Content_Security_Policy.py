import requests

def check_csp(target_url):
    try:
        response = requests.get(target_url, timeout=10)
        headers = response.headers

        csp = headers.get('Content-Security-Policy')
        if not csp:
            return True  # Vulnerable (No CSP header)

        # Basic unsafe CSP patterns
        unsafe_directives = [
            "unsafe-inline",
            "unsafe-eval",
            "*",  # Allowing all origins
            "data:",  # Permitting data URIs
            "blob:"  # Permitting blob URIs
        ]
        for directive in unsafe_directives:
            if directive in csp:
                return True  # Vulnerable CSP
        return False  # Secure CSP
    except requests.RequestException:
        return False  # Unable to test
