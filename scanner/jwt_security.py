# jwt_security.py
import jwt
import requests
import re

def is_jwt_insecure(url):
    """
    Verifies JWT token security by checking for the presence of an expiration field and verifying token's secure handling.
    """
    response = requests.get(url)
    jwt_token = response.headers.get('Authorization')
    
    if jwt_token:
        try:
            decoded_token = jwt.decode(jwt_token, options={"verify_signature": False})
            if 'exp' not in decoded_token:
                return True  # JWT has no expiration
            # Further checks for secure handling can include verifying claims and algorithms
        except jwt.DecodeError:
            return False  # Token is invalid, but not necessarily insecure
    return False
