# default_credentials.py
import requests
import re
def has_default_credentials(url):
    """
    Attempts login with common default credentials, indicating a misconfiguration if login succeeds.
    """
    default_creds = [
        ("admin", "admin"),
        ("root", "root"),
        ("user", "password"),
        ("admin", "password")
    ]
    login_url = f"{url}/login"  # Adjust endpoint as needed
    for username, password in default_creds:
        response = requests.get(login_url, data={"username": username, "password": password})
        if response.status_code == 200 and "Welcome" in response.text:
            return True  # Default credentials allowed
    return False
