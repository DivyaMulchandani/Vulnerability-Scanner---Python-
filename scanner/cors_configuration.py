# cors_configuration.py
import requests

def is_cors_configuration_insecure(url):
    """
    Checks for insecure CORS configuration by examining the headers in the response.
    """
    try:
        response = requests.get(url)
        cors_headers = response.headers.get("Access-Control-Allow-Origin", "")
        allow_credentials = response.headers.get("Access-Control-Allow-Credentials", "")
        
        # Check for insecure CORS configurations
        if cors_headers == "*" or "null" in cors_headers or (cors_headers and allow_credentials == "true"):
            return True  # Indicates an insecure CORS configuration
    except requests.RequestException as e:
        print(f"Error during CORS check: {e}")
    
    return False
