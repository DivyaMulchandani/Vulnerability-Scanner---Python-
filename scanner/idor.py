# idor.py

import requests
import re
def is_idor_vulnerable(url, test_user_id=1, unauthorized_user_id=2):
    """
    Checks for IDOR by attempting to access another user's resources without proper authorization.
    """
    test_url = f"{url}/user/{test_user_id}"
    unauthorized_url = f"{url}/user/{unauthorized_user_id}"
    
    # Simulate an authorized request
    auth_response = requests.get(test_url, headers={"Authorization": "Bearer valid_token"})
    
    # Simulate an unauthorized request
    unauth_response = requests.get(unauthorized_url, headers={"Authorization": "Bearer valid_token"})
    
    if auth_response.status_code == 200 and unauth_response.status_code == 200 and auth_response.text != unauth_response.text:
        return True  # Indicates potential IDOR vulnerability
    return False
