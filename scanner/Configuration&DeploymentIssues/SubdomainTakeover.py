import requests
import socket

##need to get domain


def check_subdomain_takeover(subdomain):
    # Check if the subdomain resolves
    try:
        ip = socket.gethostbyname(subdomain)
        response = requests.get(f"http://{subdomain}", timeout=10)
        if "no such host" in response.text.lower() or "error 404" in response.text.lower():
            return True  # Vulnerable (potential subdomain takeover)
        return False  # Not Vulnerable
    except (socket.gaierror, requests.RequestException):
        return False  # Unable to test
