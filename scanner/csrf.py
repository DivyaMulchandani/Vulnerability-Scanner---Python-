# csrf.py
import requests
import re
def is_csrf_vulnerable(url, csrf_protected_action="/profile/update"):
    """
    Tests for CSRF vulnerability by performing an action that requires CSRF protection and observing the response.
    Flags if no CSRF token is required.
    """
    # CSRF-protected action endpoint
    action_url = f"{url}{csrf_protected_action}"
    response = requests.get(action_url, data={"key": "value"}, headers={"Referer": url})
    
    # Check for lack of CSRF protection message or error response
    if response.status_code == 200 and "CSRF" not in response.text:
        return True  # No CSRF protection detected
    return False
