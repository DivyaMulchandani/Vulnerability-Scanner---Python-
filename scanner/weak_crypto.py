# weak_crypto.py
import re
import requests


def uses_weak_crypto(url):
    """
    Scans for weak cryptographic algorithms by looking for insecure ciphers in the code.
    """
    response = requests.get(url)
    weak_crypto_patterns = [
        re.compile(r"AES-\d{3}-ECB"),  # ECB mode is weak
        re.compile(r"MD5\(|SHA1\(")  # MD5 and SHA1 are outdated
    ]
    
    for pattern in weak_crypto_patterns:
        if pattern.search(response.text):
            return True  # Weak cryptographic algorithm found
    return False
