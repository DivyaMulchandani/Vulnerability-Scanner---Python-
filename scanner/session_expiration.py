# session_expiration.py
import datetime
import requests
import re

def is_session_expiration_insufficient(url):
    """
    Checks for insufficient session expiration by analyzing cookies for expiration times.
    Flags any session cookie without an expiration time or with an overly long expiration.
    """
    response = requests.get(url)
    session_cookie = response.cookies.get('sessionid')
    
    if session_cookie:
        expires = session_cookie.get('expires')
        if not expires:
            # Session cookie has no expiration set, likely insufficient
            return True
        else:
            # Convert expiration time to datetime object and check its duration
            expiration_date = datetime.datetime.strptime(expires, "%a, %d-%b-%Y %H:%M:%S GMT")
            if (expiration_date - datetime.datetime.utcnow()).days > 7:
                return True  # Expiration date is too far in the future
    return False
